!function(){let e=[];document.querySelector("#agregar-tarea").addEventListener("click",()=>{t()}),async function(){const t=new URLSearchParams(window.location.search),n="/api/tareas?url="+t.get("id");try{const t=await fetch(n),d=await t.json();if(d.tipo)return void a(d.tipo,".contenido",d.respuesta);e=d,o()}catch(e){console.log(e)}}();function t(t={}){const d=document.createElement("DIV");d.classList.add("contenedor-modal");const r=document.createElement("DIV");r.classList.add("modal");const c=document.createElement("DIV");c.classList.add("modal-botones");const i=document.createElement("input");i.classList.add("input-tarea"),i.placeholder="Nombre Tarea",i.value=t.nombre?t.nombre:"";const s=document.createElement("BUTTON");s.classList.add("boton","boton-tarea"),s.textContent=t.id?"Actualizar":"Agregar";const l=document.createElement("BUTTON");l.classList.add("boton","boton-tarea"),l.textContent="Cerrar",c.appendChild(s),c.appendChild(l),r.appendChild(i),r.appendChild(c),d.appendChild(r),document.querySelector(".tasks").appendChild(d),setTimeout(()=>{r.classList.add("mostrar")},50),l.addEventListener("click",()=>{r.classList.remove("mostrar"),setTimeout(()=>{d.remove()},600)}),s.addEventListener("click",()=>{t.id?function(e,t){if(""==t.trim())return void a("error",".modal","El nombre de la Tarea es obligatorio");!function(e,t){e.nombre=t,console.log(e),n(e,"no"),o(),a("exito",".modal","Nombre Actualizado"),setTimeout(()=>{document.querySelector(".contenedor-modal").remove()},1998)}(e,t)}(t,i.value):function(t){if(""==t.trim())return void a("error",".modal","El nombre de la Tarea es obligatorio");!async function(t){const n=new FormData,d=new URLSearchParams(window.location.search).get("id");n.append("nombre",t),n.append("estado","pendiente"),n.append("url",d);try{const d="/api/tarea",r=await fetch(d,{method:"POST",body:n}),c=await r.json();a(c.tipo,".modal",c.respuesta),t={id:c.id,nombre:t,estado:"pendiente",proyecto_id:c.proyecto_id},e.push(t),o(),console.log(e),setTimeout(()=>{document.querySelector(".contenedor-modal").remove()},1998)}catch(e){console.log(e)}}(t)}(i.value)})}function o(d=e){document.querySelector(".tareas")&&document.querySelector(".tareas").remove();const r=document.createElement("DIV");r.classList.add("tareas"),d.forEach(d=>{const c=document.createElement("DIV");c.classList.add("tarea");const i=document.createElement("DIV");i.classList.add("botones-tarea");const s=document.createElement("P");s.textContent=d.nombre;const l=document.createElement("button");l.textContent=d.estado,l.classList.add(""+("pendiente"==d.estado?"pendiente":"terminada"));const m=document.createElement("button");m.textContent="BORRAR",m.classList.add("borrar"),c.appendChild(s),i.appendChild(l),i.appendChild(m),c.appendChild(i),r.appendChild(c),m.onclick=()=>{!async function(t){const n=new URLSearchParams(window.location.search).get("id"),d=new FormData;d.append("id",t),d.append("url",n);try{const n=await fetch("/api/tarea/eliminar",{method:"POST",body:d}),r=await n.json();if(r){if(e=e.filter(e=>e.id!=t),a(r.tipo,".contenido",r.respuesta),!e.length)return void document.querySelector(".tareas").remove();o()}}catch(e){console.log(e)}}(d.id)},l.onclick=()=>{n(d,"si")},s.ondblclick=()=>{t(d)}}),function(){const t=e.filter(e=>"pendiente"==e.estado);console.log(t),t.length?document.querySelector("#pendientes").disabled=!1:document.querySelector("#pendientes").disabled=!0}(),e.filter(e=>"terminada"==e.estado).length?document.querySelector("#terminadas").disabled=!1:document.querySelector("#terminadas").disabled=!0,document.querySelector(".contenedor-tareas").appendChild(r)}async function n(t,n=""){const a=new FormData;a.append("id",t.id),a.append("nombre",t.nombre),a.append("cambiar",n);try{const d=await fetch("/api/tarea/actualizar",{method:"POST",body:a});await d.json()&&"si"==n&&(e.forEach(e=>{e.id==t.id&&"pendiente"==e.estado?e.estado="terminada":e.id==t.id&&"terminada"==e.estado&&(e.estado="pendiente")}),o(),document.querySelector(".formulario-inputs").reset())}catch(e){console.log(e)}}function a(e,t,o){if(!document.querySelector(".alertas")){const n=document.createElement("P");n.classList.add("alertas",e),n.textContent=o,document.querySelector(t).appendChild(n),setTimeout(()=>{n.remove()},2e3)}}function d(t){if("todas"==t.target.value)return void o();o(e.filter(e=>e.estado==t.target.value))}document.querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("input",d)})}();